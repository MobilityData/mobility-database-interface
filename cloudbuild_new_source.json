{
 "steps": [
   {
     "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
     "entrypoint": "bash",
     "args": [
       "-c",
       "if [ {$_ENV} == 'test']; then cp staging.yaml ./${_ENV}.yaml"
     ]
   },
  {
     "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
     "args": [
       "gcloud",
       "functions",
       "deploy",
       "add-new-source-${_ENV}",
       "--entry-point=add_new_source_cf",
       "--runtime=python39",
       "--service-account=pub-sub-publisher@top-glass-307718.iam.gserviceaccount.com",
       "--trigger-topic=before-new-source-${_ENV}",
       "--timeout=540",
       "--set-env-vars=ENV=${_ENV},GOOGLE_CLOUD_PROJECT=$PROJECT_ID",
       "--env-vars-file=${_ENV}.yaml"
     ]
   }
  ]
}

{
 "steps": [
   {
     "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
     "entrypoint": "bash",
     "args": [
       "-c",
       "if [ $_ENV == 'test' ]; then cp ./staging.yaml ./${_ENV}.yaml; fi"
     ]
   },
   {
     "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
     "args": [
       "gcloud",
       "functions",
       "deploy",
       "add-dataset-to-source-${_ENV}",
       "--entry-point=add_dataset_to_source_cf",
       "--runtime=python38",
       "--trigger-topic=before-new-dataset-${_ENV}",
       "--timeout=540",
       "--set-env-vars=ENV=${_ENV},GOOGLE_CLOUD_PROJECT=$PROJECT_ID",
       "--env-vars-file=${_ENV}.yaml"

     ]
   }
  ]
}
